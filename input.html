<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BioBug Sentinels – Input & Triage</title>
  <style>
    body { font-family: "Segoe UI", Tahoma, sans-serif; margin:0; background:#f4faf5; color:#333; }
    header { background:darkgreen; color:#fff; padding:16px 20px; }
    .wrap { max-width:900px; margin:24px auto; padding:0 16px; }
    .card { background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.08); padding:20px; margin-bottom:16px; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    label { font-weight:600; font-size:14px; }
    input, select, textarea {
      width:100%; padding:10px; border:1px solid #cfd8cf; border-radius:8px; font-size:14px; background:#fbfffb;
    }
    textarea { min-height:100px; }
    .actions { margin-top:14px; }
    button {
      background:darkgreen; color:#fff; border:none; padding:12px 18px; border-radius:8px; font-weight:700; cursor:pointer;
    }
    button:hover { background:green; }
    .muted { color:#666; font-size:13px; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; font-size:12px; font-weight:700; }
    .pill.low { background:#e8f6e8; color:#106410; }
    .pill.med { background:#fff4d9; color:#8a5b00; }
    .pill.high { background:#ffe7e7; color:#8a0000; }
    .result h3 { margin:8px 0 6px; color:#1a6d1a; }
    .back { text-decoration:none; color:darkgreen; font-weight:700; }
  </style>
</head>
<body>
  <header>
    <h2>BioBug Sentinels – Input & Triage</h2>
    <div class="muted">Heal Nexus Health Hack ’25</div>
  </header>

  <div class="wrap">
    <div class="card">
      <h3>Case Details</h3>
      <div class="row">
        <div>
          <label>Species</label>
          <select id="species">
            <option>Human</option>
            <option>Cattle</option>
            <option>Poultry</option>
            <option>Goat</option>
            <option>Sheep</option>
            <option>Pig</option>
            <option>Dog</option>
            <option>Cat</option>
          </select>
        </div>
        <div>
          <label>Location (LGA/Community)</label>
          <input id="location" placeholder="e.g., Ibadan North, Osun Farm A"/>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div>
          <label>Antibiotic Used (if any)</label>
          <input id="antibiotic" placeholder="e.g., Tetracycline, Ciprofloxacin, Amoxicillin"/>
        </div>
        <div>
          <label>Duration / Dose (free text)</label>
          <input id="duration" placeholder="e.g., 3 days, once daily"/>
        </div>
      </div>

      <div style="margin-top:10px;">
        <label>Symptoms / Notes</label>
        <textarea id="symptoms" placeholder="Describe symptoms, water/feed issues, prior treatment, outcomes..."></textarea>
      </div>

      <div class="actions">
        <button id="analyzeBtn">Analyze</button>
        <a class="back" href="index.html" style="margin-left:12px;">⬅ Back to Home</a>
      </div>
      <div class="muted" style="margin-top:8px;">
        Disclaimer: This tool is a prototype for educational/demo purposes. It does not provide medical or veterinary diagnosis. Seek a qualified professional for clinical decisions.
      </div>
    </div>

    <div class="card result" id="results" style="display:none;">
      <h3>“Research-like” Summary</h3>
      <div id="summary"></div>

      <h3 style="margin-top:14px;">Risk Estimate</h3>
      <div id="risk"></div>

      <h3 style="margin-top:14px;">Guidance (Non-diagnostic)</h3>
      <ul id="guidance"></ul>
    </div>
  </div>

  <script>
    // Minimal embedded knowledge base (offline emulator)
    const kb = {
      antibiotics: {
        tetracycline: { flags:["misuse-prone","livestock-common"], note:"Frequent misuse in livestock; watch for resistance." },
        ciprofloxacin: { flags:["critical","human-common"], note:"Important fluoroquinolone; avoid unsupervised use due to resistance risk." },
        amoxicillin: { flags:["first-line"], note:"Common broad-spectrum; incomplete courses drive resistance." },
        colistin: { flags:["last-resort","vet-restricted"], note:"Last-resort in humans; veterinary misuse is high-risk for AMR." },
        gentamicin: { flags:["injectable"], note:"Aminoglycoside; dosing errors can be harmful." },
        oxytetracycline: { flags:["livestock-common"], note:"Widely used in poultry/cattle; monitor adherence and withdrawal times." }
      },
      symptomHints: {
        diarrhea: "Consider hydration status, feed/water contamination, and recent antibiotic exposure.",
        cough: "Assess crowding, ventilation, and possible viral co-infections.",
        fever: "Flag for bacterial vs. viral differentiation; avoid blind antibiotics.",
        wound: "Check sanitation and prior topical/systemic antibiotic use.",
        abortion: "Consider zoonotic risks; seek veterinary/medical guidance.",
        weakness: "Screen for dehydration, nutrition, parasitism; avoid blind antibiotics."
      },
      riskRules: [
        // Very simple rules to emulate a model
        (ctx)=> /colistin|cipro|ciprofloxacin/i.test(ctx.antibiotic) ? "high" : null,
        (ctx)=> /tetracycline|oxytetracycline/i.test(ctx.antibiotic) && /poultry|cattle|goat|sheep|pig/i.test(ctx.species) ? "medium" : null,
        (ctx)=> /incomplete|stopped|half dose|share/i.test(ctx.symptoms) ? "high" : null,
        (ctx)=> /diarrhea|fever|cough|wound|weakness|abortion/i.test(ctx.symptoms) ? "medium" : null,
        (ctx)=> "low"
      ],
      guidanceBase: [
        "Record exact dose, duration, and response for follow-up.",
        "Avoid starting or changing antibiotics without professional advice.",
        "Improve hygiene, water quality, and isolation for symptomatic cases.",
        "If symptoms worsen or persist, seek veterinary/medical care."
      ],
      speciesTips: {
        human: ["Consider local treatment guidelines and antimicrobial stewardship."],
        poultry: ["Check ventilation, stocking density, and feed hygiene."],
        cattle: ["Review vaccination status and water source contamination."],
        goat: ["Evaluate pasture hygiene and parasite control."],
        sheep: ["Monitor flock crowding and recent weather stress."],
        pig: ["Assess biosecurity and pen sanitation."],
        dog: ["Avoid leftover human antibiotics; dosing differs."],
        cat: ["Avoid OTC antibiotics; many are unsafe or ineffective."]
      }
    };

    function analyze() {
      const species = document.getElementById('species').value.trim();
      const location = document.getElementById('location').value.trim();
      const antibiotic = document.getElementById('antibiotic').value.trim();
      const duration = document.getElementById('duration').value.trim();
      const symptoms = document.getElementById('symptoms').value.trim();

      const ctx = { species, location, antibiotic, duration, symptoms };

      // Build a “research-like” summary from local KB (no internet)
      const abxKey = antibiotic.toLowerCase();
      const abxNote = kb.antibiotics[abxKey]?.note || "No specific note in local KB.";
      const symKeys = Object.keys(kb.symptomHints).filter(k => new RegExp(k, 'i').test(symptoms));
      const symNotes = symKeys.map(k => `• ${capitalize(k)}: ${kb.symptomHints[k]}`);

      const riskLevel = kb.riskRules.map(fn => fn(ctx)).find(Boolean);
      const pill = riskLevel === "high" ? '<span class="pill high">HIGH</span>'
                 : riskLevel === "medium" ? '<span class="pill med">MEDIUM</span>'
                 : '<span class="pill low">LOW</span>';

      const speciesKey = species.toLowerCase();
      const guidance = [
        ...kb.guidanceBase,
        ...(kb.speciesTips[speciesKey] || [])
      ];

      // Render
      document.getElementById('results').style.display = 'block';
      document.getElementById('summary').innerHTML =
        `<p><strong>Species:</strong> ${escapeHtml(species)} &nbsp; | &nbsp; 
           <strong>Location:</strong> ${escapeHtml(location || '—')}</p>
         <p><strong>Antibiotic:</strong> ${escapeHtml(antibiotic || 'None provided')}</p>
         <p class="muted">${escapeHtml(abxNote)}</p>
         ${symNotes.length ? `<p><strong>Symptom considerations:</strong><br>${symNotes.join('<br>')}</p>` : '<p class="muted">No symptom-specific hints matched.</p>'}
        `;

      document.getElementById('risk').innerHTML = pill;

      const guidelist = document.getElementById('guidance');
      guidelist.innerHTML = '';
      guidance.forEach(g => {
        const li = document.createElement('li');
        li.textContent = g;
        guidelist.appendChild(li);
      });
    }

    function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
    function escapeHtml(s){ return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    document.getElementById('analyzeBtn').addEventListener('click', analyze);
  </script>
</body>
</html>
